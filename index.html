<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proposta de Cronograma do Curso de Bombeiro Civil</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body class="bg-gray-100 font-sans">
  <div class="container mx-auto p-6 max-w-4xl">
    <header class="text-center mb-8">
      <h1 class="text-4xl font-bold text-gray-800">Cronograma do Curso de Bombeiro Civil</h1>
      <p class="text-lg text-gray-600 mt-2">Proposta para Programa de Treinamento de 32 Encontros</p>
    </header>

    <div class="bg-white shadow-lg rounded-lg p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-semibold text-gray-700">Linha do Tempo do Curso</h2>
        <button id="downloadPdf" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Baixar como PDF</button>
      </div>
      <div id="timeline" class="space-y-6">
        <!-- Entradas do cronograma serão inseridas aqui dinamicamente -->
      </div>
    </div>

    <footer class="text-center mt-8 text-gray-600">
      <p>Preparado para Revisão do Diretor | Programa de Treinamento de Bombeiro Civil</p>
    </footer>
  </div>

  <script>
    const cronograma = [
      { encontro: 1, modulo: "Fundamentos Profissionais", titulo: "Abertura de Turma", tipo: "Introdução", dia: "A Definir" },
      { encontro: 2, modulo: "Fundamentos Profissionais", titulo: "Venda do Fire Class", tipo: "Introdução", dia: "A Definir" },
      { encontro: 3, modulo: "Fundamentos Profissionais", titulo: "Relações Humanas (Teoria)", tipo: "RH", dia: "A Definir" },
      { encontro: 4, modulo: "Fundamentos Profissionais", titulo: "Legislação Aplicada (Teoria)", tipo: "LA", dia: "A Definir" },
      { encontro: 5, modulo: "Fundamentos Profissionais", titulo: "Revisão de R.H. e L.A.", tipo: "RH/LA", dia: "A Definir" },
      { encontro: 6, modulo: "Fundamentos Profissionais", titulo: "Prova de R.H. e L.A.", tipo: "RH/LA", dia: "A Definir" },
      { encontro: 7, modulo: "Técnicas de Salvamento", titulo: "Código Q e Alfabeto Fonético", tipo: "Geral", dia: "A Definir" },
      { encontro: 8, modulo: "Técnicas de Salvamento", titulo: "Salvamento (Teoria)", tipo: "Salvamento", dia: "A Definir" },
      { encontro: 9, modulo: "Técnicas de Salvamento", titulo: "Prática Externa Salvamento", tipo: "Salvamento", dia: "Domingo" },
      { encontro: 10, modulo: "Técnicas de Salvamento", titulo: "Revisão de Salvamento (Teórica)", tipo: "Salvamento", dia: "A Definir" },
      { encontro: 11, modulo: "Técnicas de Salvamento", titulo: "Prova de Salvamento (Teórica)", tipo: "Salvamento", dia: "A Definir" },
      { encontro: 12, modulo: "Técnicas de Salvamento", titulo: "Prática Externa Salvamento", tipo: "Salvamento", dia: "A Definir" },
      { encontro: 13, modulo: "Prevenção e Combate a Incêndios", titulo: "PCI (Teoria)", tipo: "PCI", dia: "A Definir" },
      { encontro: 14, modulo: "Prevenção e Combate a Incêndios", titulo: "PCI (Teoria)", tipo: "PCI", dia: "Domingo" },
      { encontro: 15, modulo: "Prevenção e Combate a Incêndios", titulo: "PCI (Teoria)", tipo: "PCI", dia: "A Definir" },
      { encontro: 16, modulo: "Prevenção e Combate a Incêndios", titulo: "PCI (Teoria)", tipo: "PCI", dia: "A Definir" },
      { encontro: 17, modulo: "Prevenção e Combate a Incêndios", titulo: "PCI (Revisão Teórica)", tipo: "PCI", dia: "A Definir" },
      { encontro: 18, modulo: "Prevenção e Combate a Incêndios", titulo: "PCI (Prova Teórica)", tipo: "PCI", dia: "A Definir" },
      { encontro: 19, modulo: "Prevenção e Combate a Incêndios", titulo: "PCI (Prática)", tipo: "PCI", dia: "Domingo" },
      { encontro: 20, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Teoria)", tipo: "APH", dia: "A Definir" },
      { encontro: 21, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Teoria)", tipo: "APH", dia: "A Definir" },
      { encontro: 22, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Teoria)", tipo: "APH", dia: "A Definir" },
      { encontro: 23, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Teoria)", tipo: "APH", dia: "A Definir" },
      { encontro: 24, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Revisão Teórica)", tipo: "APH", dia: "Domingo" },
      { encontro: 25, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Prova Teórica)", tipo: "APH", dia: "A Definir" },
      { encontro: 26, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Prática)", tipo: "APH", dia: "A Definir" },
      { encontro: 27, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Prática)", tipo: "APH", dia: "A Definir" },
      { encontro: 28, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Prática)", tipo: "APH", dia: "A Definir" },
      { encontro: 29, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "APH (Prática)", tipo: "APH", dia: "Domingo" },
      { encontro: 30, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "Recuperação (Revisão)", tipo: "Recuperação", dia: "A Definir" },
      { encontro: 31, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "Recuperação (RH / L.A. / SAL)", tipo: "Recuperação", dia: "A Definir" },
      { encontro: 32, modulo: "Atendimento Pré-Hospitalar e Consolidação", titulo: "Recuperação (PCI / APH)", tipo: "Recuperação", dia: "A Definir" }
    ];

    const coresTipo = {
      Introdução: "bg-blue-100 text-blue-800",
      RH: "bg-green-100 text-green-800",
      LA: "bg-green-100 text-green-800",
      "RH/LA": "bg-green-100 text-green-800",
      Geral: "bg-yellow-100 text-yellow-800",
      Salvamento: "bg-red-100 text-red-800",
      PCI: "bg-purple-100 text-purple-800",
      APH: "bg-orange-100 text-orange-800",
      Recuperação: "bg-gray-100 text-gray-800"
    };

    const moduloCores = {
      "Fundamentos Profissionais": "border-l-4 border-blue-600",
      "Técnicas de Salvamento": "border-l-4 border-red-600",
      "Prevenção e Combate a Incêndios": "border-l-4 border-purple-600",
      "Atendimento Pré-Hospitalar e Consolidação": "border-l-4 border-orange-600"
    };

    function renderCronograma() {
      const timeline = document.getElementById('timeline');
      let semana = 0;
      let encontrosNaSemana = 0;
      let moduloAtual = "";

      cronograma.forEach((item, index) => {
        if (encontrosNaSemana === 0) {
          semana++;
          const cabecalhoSemana = document.createElement('div');
          cabecalhoSemana.className = 'text-lg font-bold text-gray-600 mt-6';
          cabecalhoSemana.textContent = `Semana ${semana}`;
          timeline.appendChild(cabecalhoSemana);
        }

        if (item.modulo !== moduloAtual) {
          moduloAtual = item.modulo;
          const cabecalhoModulo = document.createElement('div');
          cabecalhoModulo.className = 'text-xl font-semibold text-gray-700 mt-4 mb-2';
          cabecalhoModulo.textContent = `Módulo: ${moduloAtual}`;
          timeline.appendChild(cabecalhoModulo);
        }

        const entrada = document.createElement('div');
        entrada.className = `flex items-start p-4 rounded-lg ${coresTipo[item.tipo]} ${moduloCores[item.modulo]} pl-6 mb-2`;
        entrada.innerHTML = `
          <div class="flex-shrink-0 w-12 h-12 bg-gray-800 text-white rounded-full flex items-center justify-center font-bold">
            ${item.encontro}
          </div>
          <div class="ml-4">
            <h3 class="text-lg font-semibold">${item.titulo}</h3>
            <p class="text-sm">Dia: ${item.dia} | Tipo: ${item.tipo}</p>
          </div>
        `;
        timeline.appendChild(entrada);

        encontrosNaSemana++;
        if (item.dia === "Domingo" || encontrosNaSemana >= 5 || index === cronograma.length - 1) {
          encontrosNaSemana = 0;
        }
      });
    }

    document.getElementById('downloadPdf').addEventListener('click', () => {
      const elemento = document.querySelector('.container');
      html2pdf().from(elemento).save('Proposta_Cronograma_Bombeiro_Civil.pdf');
    });

    renderCronograma();
  </script>
</body>
</html>